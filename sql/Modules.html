<!doctype HTML>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="codemirror.js"></script>
<script src="runmode.js"></script>
<script src="pyret.js"></script>
<script src="hilite.js"></script>
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>4.4&nbsp;Modules</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="codemirror.css" title="default"/><link rel="stylesheet" type="text/css" href="pyret.css" title="default"/><link rel="stylesheet" type="text/css" href="styles.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Pyret</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Getting_Started.html" class="tocviewlink" data-pltdoc="x">Getting Started</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Language_Concepts.html" class="tocviewlink" data-pltdoc="x">Language Concepts</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Builtins_and_Libraries.html" class="tocviewlink" data-pltdoc="x">Builtins and Libraries</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Internals.html" class="tocviewselflink" data-pltdoc="x">Internals</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>4&nbsp;</td><td><a href="Internals.html" class="tocviewlink" data-pltdoc="x">Internals</a></td></tr></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">4.1&nbsp;</td><td><a href="runtime.html" class="tocviewlink" data-pltdoc="x">Runtime API</a></td></tr><tr><td align="right">4.2&nbsp;</td><td><a href="ffi.html" class="tocviewlink" data-pltdoc="x">FFI Helpers</a></td></tr><tr><td align="right">4.3&nbsp;</td><td><a href="s_running.html" class="tocviewlink" data-pltdoc="x">Running Code (Safely)</a></td></tr><tr><td align="right">4.4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Modules</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9658;</a></td><td>4.4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Modules</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right">4.4.1&nbsp;</td><td><a href="#%28part._s~3amodule-rep%29" class="tocviewlink" data-pltdoc="x">Representation</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">4.4.1<tt>&nbsp;</tt></span><a href="#%28part._s~3amodule-rep%29" class="tocsubseclink" data-pltdoc="x">Representation</a></td></tr><tr><td><span class="tocsublinknumber">4.4.1.1<tt>&nbsp;</tt></span><a href="#%28part._s~3asingle-module%29" class="tocsubseclink" data-pltdoc="x">Single Modules</a></td></tr><tr><td><span class="tocsublinknumber">4.4.1.2<tt>&nbsp;</tt></span><a href="#%28part._s~3acomplete%29" class="tocsubseclink" data-pltdoc="x">Complete Programs</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="s_running.html" title="backward to &quot;4.3 Running Code (Safely)&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Internals.html" title="up to &quot;4 Internals&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h4>4.4<tt>&nbsp;</tt><a name="(part._.Modules)"></a>Modules</h4><h5>4.4.1<tt>&nbsp;</tt><a name="(part._s~3amodule-rep)"></a>Representation</h5><h5>4.4.1.1<tt>&nbsp;</tt><a name="(part._s~3asingle-module)"></a>Single Modules</h5><p>Modules are represented as JavaScript object literals.  Aside from the
<span class="stt">theModule</span> field, which contains the compiled code of the module, they
follow a JSON-structured schema.  The format has several design goals:</p><ul><li><p><div class="SIntrapara">It should not require any free or global JavaScript identifiers beyond
chapter 15 of the ES5 spec, allowing the compiler and runtime system to
parameterize the module by its context.</div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Some modules, like images
and the world library, use global variables like <span class="stt">document</span>, though we&rsquo;d
like to refactor them so they don&rsquo;t need to.</p></blockquote></blockquote></blockquote></div></p></li><li><p>It should be reasonable for a developer to write by hand, so that modules
in pure JavaScript can seamlessly co-exist with compiled Pyret modules.</p></li><li><p>It should be simple for the compiler to produce and consume.</p></li><li><p>It should contain the information necessary for its dependents to be
statically checked, without consulting the original source program.</p></li></ul><p>A module, whether compiled or handwritten, has the following form:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">module := {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">"requires": [&lt;require&gt;, ...],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">"provides": &lt;provides&gt;,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">"nativeRequires": [&lt;nativeRequire&gt;, ...],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">"theModule": &lt;moduleFunction&gt;</span></p></td></tr><tr><td><p><span class="stt">}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">require :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { "import-type": "builtin", "name": &lt;string&gt; }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { "import-type": "dependency", "protocol": &lt;string&gt;, "args": [&lt;string&gt;, ...] }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">nativeRequire :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| &lt;string&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">provides :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">{</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">aliases: { &lt;name&gt;: &lt;type&gt;, ... },</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">values: { &lt;name&gt;: &lt;type&gt;, ... },</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">datatypes: { &lt;name&gt;: &lt;type&gt;, ... }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">// &lt;type&gt;s in shorthands cannot use shorthands as types</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">// (described below)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">shorthands: { &lt;name&gt;: &lt;type&gt;, ... },</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">prim-type :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| "tany" | "Number" | "String" | "Boolean" | "Any" | "Nothing"</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">type :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| &lt;prim-type&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| &lt;type-full&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| &lt;type-array&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| &lt;string-defined-in-shorthands&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">type-full :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { tag: "any" }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { tag: "name", origin: &lt;require&gt;, name: &lt;string&gt; }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { tag: "forall", args: [&lt;string&gt;, ...], onto: &lt;type&gt; }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { tag: "arrow", args: [&lt;type&gt;, ...], ret: &lt;type&gt; }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { tag: "tyapp", onto: &lt;type&gt;, args: [&lt;type&gt;, ...] }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { tag: "tyvar", name: &lt;string&gt; }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { tag: "record", fields: { &lt;name&gt;: &lt;type&gt; }, ... }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { tag: "data",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">name: &lt;string&gt;,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">params: [&lt;string&gt;, ...],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">variants: [&lt;variant-full&gt;, ...],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">methods: { &lt;name&gt;: &lt;type&gt;, ... }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">variant-full :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { tag: "variant",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">name: &lt;string&gt;,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">vmembers: [&lt;vmember-full&gt;, ...]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { tag: "singleton-variant", name: &lt;string&gt; }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">vmember-full :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| { tag: "variant-member", name: &lt;string&gt;, kind: &lt;variant-kind&gt;, typ: &lt;type&gt; }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">variant-kind :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| "normal" | "ref"</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">type-array :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["Array", &lt;type&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["RawArray", &lt;type&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["Option", &lt;type&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["List", &lt;type&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"># type of args, resulting constructed type</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["Maker", &lt;type&gt;, &lt;type&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["arrow", [&lt;type&gt;, ...], &lt;type&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["data",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&lt;string&gt;,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[&lt;string&gt;, ...],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[&lt;variant-array&gt;, ...],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">{ &lt;name&gt;: &lt;type&gt;, ... }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["tid", &lt;string&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["forall", [&lt;string&gt;, ...], &lt;type&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["local", &lt;string&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["record", { &lt;name&gt;: &lt;type&gt;, ... }]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["tyapp", &lt;type&gt;, [&lt;type&gt;, ...]]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">variant-array :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| [&lt;string&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| [&lt;string&gt;, [&lt;vmember-array&gt;, ...]]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">vmember-array :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| [&lt;string&gt;, &lt;type&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| ["ref", &lt;string&gt;, &lt;type&gt;]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">moduleFunction :=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| function(runtime, namespace, uri, &lt;id&gt;, ..., &lt;id&gt;, ...) {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">// compiled or handwritten JavaScript code</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr></table></p><p>The first three fields&#8212;<span class="stt">requires</span>, <span class="stt">provides</span>, and
<span class="stt">nativeRequires</span>&#8212;hold static information about the modules dependencies and
exports.</p><p><span class="SSubSubSubSection"><span style="font-weight: bold">requires</span></span></p><p>The <span class="stt">requires</span> field holds the compiled equivalent of an <span class="stt">import</span> line.
This includes the kind of import, and any parameters that are part of the
import statement.  For example, the import line <span class="stt">import
file("./lib/helpers.arr") as H</span> would show up in the compiled code as</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">{ "import-type": "dependency",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">"protocol": "file",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">"args": ["./lib/helpers.arr"] }</span></p></td></tr></table></p><p>Builtin imports, like <span class="stt">lists</span> and <span class="stt">sets</span>, have an <span class="stt">import-type</span> of
<span class="stt">"builtin"</span>:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">{ "import-type": "builtin", name: "lists" }</span></p></td></tr></table></p><p>Note that the <span class="stt">require</span> can be generated from an import line without any
special context information.  For example, in the example above, the path is
not resolved to an absolute path.  This happens later in [REF].  This decision
in large part supports the goal of handwritten modules, where it would be
onerous to fill in absolute paths and keep track of them.</p><p><span class="SSubSubSubSection"><span style="font-weight: bold">provides</span></span></p><p><span class="stt">provides</span> describe the types exported from a module.  This includes:</p><ul><li><p>The types of exported <span class="stt">values</span>.  So, for example, a program that
  defines</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">x :: Number = 22</span></p></td></tr></table></p><p>would have the following in its in its compiled <span class="stt">provides.values</span>:</p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">x: "Number"</span></p></td></tr></table></li><li><p>The types of exported <span class="stt">aliases</span>.  For example, a program that
  defines</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">type Point = { x :: Number, y :: Number }</span></p></td></tr></table></p><p>would have the following in its compiled <span class="stt">provides.aliases</span>:</p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Point: {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">tag: "record",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">fields: { x: "Number", y: "Number" }</span></p></td></tr><tr><td><p><span class="stt">}</span></p></td></tr></table></li><li><p>Any exported <span class="stt">datatypes</span>.  For example, a program that defines</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">data Point:</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| point(x :: Number, y :: Number)</span></p></td></tr><tr><td><p><span class="stt">end</span></p></td></tr></table></p><p>would have the following in its compiled <span class="stt">provides.datatypes</span>:</p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Point: {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">tag: "data",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">name: "Point",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">params: [],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">variants: [</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">{</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">tag: "variant",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">name: "point",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">vmembers: [</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">{</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">tag: "variant-member",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">kind: "normal",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">name: "x"</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">typ: "Number"</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">},</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">{</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">tag: "variant-member",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">kind: "normal",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">name: "y"</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">typ: "Number"</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">methods: {}</span></p></td></tr><tr><td><p><span class="stt">}</span></p></td></tr></table></li></ul><p>Writing out all of the types fully, with <span class="stt">tag</span> and so on, is quite a bit of
typing for handwritten modules.  So these types can also be specified in an
array notation, where the first element of the array is typically a string
indicating the tag, and the rest of the array describes the type positionally.
So, for example, the datatype for <span class="stt">Point</span> could be written:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">Point: ["data",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"Point",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">["variant", "point", [["x", "Number"], ["y", "Number"]]]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">{}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">]</span></p></td></tr></table></p><p>Both styles are fully supported and can be interchanged.</p><p>Since often modules refer to the same type many times, it can be painful to
write out the same type over and over in a handwritten specification.  The
<span class="stt">provides</span> declaration also allows specification of <span class="stt">shorthands</span>, which
are not new types exported by the module, but rather shortcuts for writing out
its types.  For example, a module that implements dictionaries from a key type
<span class="stt">K</span> to a value type <span class="stt">V</span> will likely use a type like this repeatedly:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">["tyapp", ["local", "Dict"], [["tid", "K"], ["tid", "V"]]]</span></p></td></tr></table></p><p>That is, the locally-defined (within this module) type <span class="stt">Dict</span>, parameterized
by two type variables.  Instead of writing:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">{</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">values: {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"new-dict": ["forall", ["K", "V"], ["arrow", [],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">["tyapp", ["local", "Dict"], [["tid", "K"], ["tid", "V"]]]]],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"set": ["forall", ["K", "V"], ["arrow",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">["tyapp", ["local", "Dict"], [["tid", "K"], ["tid", "V"]]]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">["tid", "K"],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">["tid", "V"]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">["tyapp", ["local", "Dict"], [["tid", "K"], ["tid", "V"]]]]],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"get": ["forall", ["K", "V"], ["arrow",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">["tyapp", ["local", "Dict"], [["tid", "K"], ["tid", "V"]]]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">["tid", "K"],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">["Option", "V"]]]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// aliases and types and so on</span></p></td></tr><tr><td><p><span class="stt">}</span></p></td></tr></table></p><p>It&rsquo;s easier to define:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">{</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">shorthands: {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">dOfKV: ["tyapp", ["local", "Dict"], [["tid", "K"], ["tid", "V"]]]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">},</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">values: {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"new-dict": ["forall", ["K", "V"], ["arrow", [], dofKV]],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"set": ["forall", ["K", "V"], ["arrow",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[ dOfKV, ["tid", "K"], ["tid", "V"] ],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">dOfKV]],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">"get": ["forall", ["K", "V"], ["arrow",</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[ dOfKV, ["tid", "K"], ],</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">["Option", "V"]]]</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// aliases and types and so on</span></p></td></tr><tr><td><p><span class="stt">}</span></p></td></tr></table></p><p>There are several examples of the uses of these declarations in [REF].</p><p>Some "shorthands with options" are predefined, namely <span class="stt">Option</span>, <span class="stt">Array</span>,
<span class="stt">RawArray</span>, <span class="stt">List</span>, and <span class="stt">Maker</span>.  The first four of these are
straightforward, single-argument type constructors.  The last one describes the
type of <span class="stt">list</span> in <span class="stt">[list: ...]</span>, namely, the type of the object whose
fields allow for the construction of composite values.  Makers accept two type
arguments: the type of the <span class="stt">...</span> arguments in the constructor notation, and
the resulting type of the constructed value.</p><p><span class="SSubSubSubSection"><span style="font-weight: bold">nativeRequires</span></span></p><p>Describe dependencies of the module that are not Pyret-based.  The strings in
<span class="stt">nativeRequires</span> are processed not by Pyret&rsquo;s module loading system, but by
a (configurable) use of RequireJS.  This is discussed later in [REF].</p><p>Pyret distinguishes <span class="stt">nativeRequires</span> for several reasons.  In some contexts,
like running on Node, there needs to be some mechanism for accessing system
libraries like <span class="stt">fs</span> for filesystem access.  In addition, there are numerous
JavaScript libraries implemented in RequireJS format, and it&rsquo;s useful to have a
way for handwritten Pyret modules to import and use them directly.  To avoid
using global scope or other mechanisms, the runtime uses RequireJS as a
standard way to locate and load these modules.</p><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Of course, this also assumes that code is run within a sandbox so
it cannot simply <span class="stt">eval</span> its way to arbitrary behavior.  While Pyret doesn&rsquo;t
currently run within something like Caja [REF] when evaled, it is a long-term
goal.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara"> In addition, with the assumption that modules do not rely on globals,
this makes the task of auditing modules for their use of special, non-language
behavior easier, since such an audit can start from the <span class="stt">nativeRequires</span>
specifications across all modules.</div></p><p><span class="SSubSubSubSection"><span style="font-weight: bold">theModule</span></span></p><p>The final field, <span class="stt">theModule</span>, holds a function that implements the module&rsquo;s
behavior, and constructs the values that it provides.  Its arguments have a
particular shape:</p><ul><li><p><span style="font-weight: bold">runtime</span> &#8211; the first argument is the current runtime (as described
in <a href="runtime.html#%28part._s~3aruntime-object%29" data-pltdoc="x">The Pyret Runtime</a>).  This is the entrypoint for most interesting
built-in Pyret behavior, and used pervasively in compiled and handwritten
modules alike.</p></li><li><p><span style="font-weight: bold">namespace</span> &#8211; the second argument is a dictionary object, called a
namespace [REF], that holds the mappings for global identifiers and types
available in the module.  This is seldom useful in handwritten code; its main
use is in modules at the REPL that have an interesting and changing set of
globally-available names.</p></li><li><p><span style="font-weight: bold">uri</span> &#8211; the third argument is the URI of the module, as a string.
Since the same code could be loaded for different purposes (e.g. a Google Drive
module loaded both from a shared import and a path import), a module does not
store its URI at compile time.  The URI is provided when the module is
instantiated, which can be used for logging, reporting error messages, and
other unique module identification purposes.</p></li><li><p><span style="font-weight: bold">requires</span> ids &#8211; After <span class="stt">uri</span>, there should be a number of
identifiers equal to the number of <span class="stt">require</span>s listed.  These will hold the
module objects [REF] for the specified dependencies when the module is loaded.</p></li><li><p><span style="font-weight: bold">nativeRequires</span> ids &#8211; After the <span class="stt">requires</span> ids, there should be
a number of identifiers equal to the number of <span class="stt">nativeRequires</span> listed.
These will hold the values returned from using RequireJS on the native
dependencies when the module is loaded.</p></li></ul><h5>4.4.1.2<tt>&nbsp;</tt><a name="(part._s~3acomplete)"></a>Complete Programs</h5><p>Modules as described in <a href="#%28part._s~3asingle-module%29" data-pltdoc="x">Single Modules</a> lack the necessary
information and context to run &#8211;&#160;their dependencies must still be provided,
most crucially, and the runtime needs to know in which order to run them.</p><p>To this end, Pyret also specifies a format for complete programs, which
contains all the information needed to run a program, given a runtime and an
implementation of RequireJS.  Running such a complete program, which can be
done in several ways, is discussed in [REF].  This section lays out and
motivates its structure.  This structure is not intended to be written by hand.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">program := {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">staticModules: &lt;staticModules&gt;,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">depMap: &lt;depmap&gt;,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">toLoad: [&lt;uri&gt;, ...],</span></p></td></tr><tr><td><p><span class="stt">}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">depmap := { &lt;uri&gt;: { &lt;dependency&gt; : &lt;uri&gt;, ... }, ... }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">staticModules := { &lt;uri&gt;: &lt;module&gt;, ... }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">dependency := string encoding of &lt;require&gt;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">module := as above</span></p></td></tr></table></p><p>The dictionary of <span class="stt">staticModules</span> maps from uri to module structures as
described in <a href="#%28part._s~3asingle-module%29" data-pltdoc="x">Single Modules</a>.  This includes all the Pyret-based
modules and code that the program will use.  It&rsquo;s worth noting that the
information in the <span class="stt">provides</span> block is (potentially) extraneous if the only
goal is to run the program.  However, if compiled modules are to provide enough
information to e.g. type-check code that is linked against them in the future,
it&rsquo;s worth keeping this static information around.</p><p>The <span class="stt">depmap</span> indicates, for each listed <span class="stt">require</span> dependency, which
module should be used to satisfy it.  This is indicated by mapping from a
string representation of the <span class="stt">require</span> to the URI for the appropriate
module.  The string encoding is straightforward, and creates a string that
looks much like the original import line.  For example, a <span class="stt">require</span> like:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">{ "import-type": "dependency", "protocol": "file", "args": ["./lib/helpers.arr"] }</span></p></td></tr></table></p><p>would appear encoded as</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">file(./lib/helpers.arr)</span></p></td></tr></table></p><p>The <span class="stt">toLoad</span> list indicates the order in which the modules should be loaded.
It should always be a valid topological sort of the graph implicit in
<span class="stt">depmap</span>.  In that sense, it&rsquo;s not strictly necessary information, but it
makes running a generated program much more straightforward, since its clear in
which order to instantiate modules.  This also makes it easy to determine the
main entrypoint for the program, which is the <span style="font-style: italic">last</span> module indicated in
the <span class="stt">toLoad</span> list.  That is, the modules leading up to the last one are
exactly its (transitive) dependencies, and run in order to create their
exports, which will be used later in the <span class="stt">toLoad</span> list to instantiate
further modules.</p><p>Concretely, the first few modules in the <span class="stt">toLoad</span> list are typically
builtins, like <span class="stt">lists</span> and <span class="stt">error</span>, required for just about every program.
Increasing indices in the <span class="stt">toLoad</span> list tend towards user-implemented code
until finally reaching the main module that the user requested be compiled.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="s_running.html" title="backward to &quot;4.3 Running Code (Safely)&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="Internals.html" title="up to &quot;4 Internals&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>